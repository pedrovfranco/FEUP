package recipes;

import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

public class RecipeStep extends Ingredient
{
	private String name;
	private String action;
	
	private List< Pair<Ingredient, Float> > ingredients = new ArrayList< Pair<Ingredient, Float> >();
	
	public RecipeStep(String name, String action)
	{
		super(name);
		
		if(action == null)
			throw new IllegalArgumentException();
		
		this.name = name;
		this.action = action;
	}
	
	public String getName()
	{
		return name;
	}
	
	public String getAction()
	{
		return action;
	}
	
	public void addIngredient(Ingredient input, float quantity)
	{
		Pair<Ingredient, Float> foo = new Pair<Ingredient, Float>(input, quantity);
		
		for (int i = 0;  i < ingredients.size(); i++)
		{
			if (ingredients.get(i).getFirst().equals(input))
				return;
		}
		
		ingredients.add(foo);
	}
	
	public void addIngredient(Ingredient input, int quantity)
	{
		this.addIngredient(input, new Float(quantity));
	}
	
	public void addIngredient(RecipeStep input, float quantity)
	{
		addIngredient(Input, quantity);
	}
	
	public Float getQuantity(Ingredient input)
	{
		Float sum = new Float(0);
		
		for (int i = 0; i < ingredients.size(); i++)
		{
			if (ingredients.get(i).getFirst() instanceof RecipeStep)
			{
				RecipeStep foo = (RecipeStep) ingredients.get(i).getFirst();
				
				sum += foo.getQuantity(input);	
			}
			else
			{
				if (ingredients.get(i).getFirst().getName().equals(input.getName()))
					sum += ingredients.get(i).getSecond();
			}
		}
		
		return sum;
	}
	
	public int getIngredientCount()
	{
		return ingredients.size();
	}
	
	public List< Pair<Ingredient, Float> > getIngredients()
	{
		return ingredients;
	}
	
	@Override
	public String toString()
	{
		Collections.sort(ingredients, new LexicographicComparator());
		
		String res = "to make " + name + ", " + action + " ";
		
		for (int i = 0; i < ingredients.size(); i++)
		{
			res += ingredients.get(i).getSecond() + " " + ingredients.get(i).getFirst().getName();
			
			if (i != ingredients.size()-1) //If not last one
				res += ", ";
		}
		
		return res;
	}
}
